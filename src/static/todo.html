<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¾…åŠäº‹é¡¹ - åç«¯æ¥å£ç‰ˆ</title>
    <style>
        :root {
            --primary-color: #4361ee;
            --secondary-color: #3a56d4;
            --success-color: #4cc9f0;
            --danger-color: #f72585;
            --warning-color: #f8961e;
            --light-color: #f8f9fa;
            --dark-color: #212529;
            --border-radius: 10px;
            --box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            animation: fadeIn 0.5s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        header {
            text-align: center;
            margin-bottom: 40px;
            padding-top: 20px;
        }
        
        .app-title {
            font-size: 2.8rem;
            font-weight: 700;
            background: linear-gradient(to right, var(--primary-color), var(--success-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            letter-spacing: -0.5px;
        }
        
        .app-subtitle {
            color: #666;
            font-size: 1.1rem;
            font-weight: 300;
        }
        
        .main-content {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            overflow: hidden;
            margin-bottom: 30px;
        }
        
        .todo-form {
            padding: 30px;
            background-color: var(--light-color);
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }
        
        .form-title {
            font-size: 1.4rem;
            margin-bottom: 20px;
            color: var(--dark-color);
            font-weight: 600;
        }
        
        .form-group {
            display: flex;
            gap: 15px;
        }
        
        .todo-input {
            flex: 1;
            padding: 16px 20px;
            border: 2px solid #e9ecef;
            border-radius: var(--border-radius);
            font-size: 1.1rem;
            transition: var(--transition);
        }
        
        .todo-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.1);
        }
        
        .add-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 0 35px;
            border-radius: var(--border-radius);
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            letter-spacing: 0.5px;
        }
        
        .add-btn:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(67, 97, 238, 0.2);
        }
        
        .api-config {
            padding: 20px 30px;
            background-color: #f8fafc;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }
        
        .config-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: var(--dark-color);
            font-weight: 600;
        }
        
        .api-url-input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
            font-family: monospace;
        }
        
        .api-url-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.1);
        }
        
        .todo-stats {
            display: flex;
            justify-content: space-between;
            padding: 25px 30px;
            background-color: #f8fafc;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
            line-height: 1;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #6c757d;
            margin-top: 5px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .todo-list-container {
            padding: 10px;
            max-height: 500px;
            overflow-y: auto;
        }
        
        .todo-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .todo-item {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.04);
            display: flex;
            align-items: center;
            gap: 20px;
            transition: var(--transition);
            border-left: 5px solid transparent;
        }
        
        .todo-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
        }
        
        .todo-item.completed {
            background-color: #f8f9fa;
            border-left-color: var(--success-color);
        }
        
        .todo-item.completed .todo-text {
            text-decoration: line-through;
            color: #8a94a6;
        }
        
        .todo-checkbox-container {
            position: relative;
            width: 26px;
            height: 26px;
        }
        
        .todo-checkbox {
            width: 100%;
            height: 100%;
            cursor: pointer;
            opacity: 0;
            position: absolute;
            z-index: 2;
        }
        
        .custom-checkbox {
            position: absolute;
            top: 0;
            left: 0;
            width: 26px;
            height: 26px;
            border: 2px solid #dee2e6;
            border-radius: 6px;
            background-color: white;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .todo-checkbox:checked ~ .custom-checkbox {
            background-color: var(--success-color);
            border-color: var(--success-color);
        }
        
        .todo-checkbox:checked ~ .custom-checkbox::after {
            content: 'âœ“';
            color: white;
            font-weight: bold;
            font-size: 14px;
        }
        
        .todo-content {
            flex: 1;
        }
        
        .todo-text {
            font-size: 1.2rem;
            font-weight: 500;
            margin-bottom: 5px;
            color: var(--dark-color);
            word-break: break-word;
        }
        
        .todo-meta {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .todo-id {
            font-size: 0.85rem;
            color: #8a94a6;
            background-color: #f1f3f5;
            padding: 3px 10px;
            border-radius: 20px;
            font-weight: 500;
        }
        
        .todo-status {
            font-size: 0.85rem;
            color: #8a94a6;
            font-weight: 500;
        }
        
        .todo-status.completed {
            color: var(--success-color);
        }
        
        .todo-status.pending {
            color: var(--warning-color);
        }
        
        .todo-actions {
            display: flex;
            gap: 10px;
        }
        
        .todo-btn {
            background: none;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            color: #8a94a6;
        }
        
        .todo-btn:hover {
            background-color: #f8f9fa;
            color: var(--dark-color);
        }
        
        .loading-state {
            text-align: center;
            padding: 60px 20px;
            color: #8a94a6;
        }
        
        .loading-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.5;
            animation: spin 2s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-title {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: #6c757d;
        }
        
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #8a94a6;
        }
        
        .empty-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.5;
        }
        
        .empty-title {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: #6c757d;
        }
        
        .error-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--danger-color);
            background-color: rgba(247, 37, 133, 0.1);
            border-radius: var(--border-radius);
            margin: 20px;
        }
        
        .error-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.8;
        }
        
        .error-title {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: var(--danger-color);
        }
        
        .error-description {
            font-size: 1rem;
            max-width: 400px;
            margin: 0 auto;
            line-height: 1.6;
            color: #666;
        }
        
        .footer {
            text-align: center;
            color: #8a94a6;
            font-size: 0.9rem;
            padding: 20px;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 1000;
            opacity: 0;
            transform: translateX(100px);
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            max-width: 300px;
        }
        
        @media (max-width: 768px) {
            .app-title {
                font-size: 2.2rem;
            }
            
            .todo-form {
                padding: 20px;
            }
            
            .form-group {
                flex-direction: column;
            }
            
            .add-btn {
                width: 100%;
                padding: 16px;
            }
            
            .todo-stats {
                flex-direction: column;
                gap: 20px;
            }
            
            .todo-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .todo-actions {
                align-self: flex-end;
            }
        }
    </style>
</head>
<body>    
    <!--#content-->
    <div class="container">
        <header>
            <h1 class="app-title">å¾…åŠäº‹é¡¹ç®¡ç†</h1>
        </header>
        
        <main class="main-content">
            <div class="todo-form">
                <h2 class="form-title">æ·»åŠ æ–°ä»»åŠ¡</h2>
                <div class="form-group">
                    <input type="text" class="todo-input" id="todo-input" placeholder="è¾“å…¥æ–°çš„å¾…åŠäº‹é¡¹...">
                    <button class="add-btn" id="add-btn">æ·»åŠ ä»»åŠ¡</button>
                </div>
            </div>
            
            <div class="todo-stats">
                <div class="stat-item">
                    <div class="stat-value" id="total-count">0</div>
                    <div class="stat-label">æ€»ä»»åŠ¡æ•°</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="completed-count">0</div>
                    <div class="stat-label">å·²å®Œæˆ</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="pending-count">0</div>
                    <div class="stat-label">å¾…å®Œæˆ</div>
                </div>
            </div>
            
            <div class="todo-list-container">
                <div class="todo-list" id="todo-list">
                    <!-- Todo items will be loaded here -->
                </div>
            </div>
        </main>
    </div>

    <script>
        // åˆå§‹æ•°æ® - ä½¿ç”¨æä¾›çš„JSON
        const initialTodos = [
            {"id":2,"todo":"googgogogogogogog","status":false},
            {"id":3,"todo":"ä½ æ„¿æœ›å®ç°äº†å—","status":true},
            {"id":4,"todo":"ä½ æ„¿æœ›å®ç°äº†å—","status":true},
            {"id":1,"todo":"ä»Šå¤©å¹²è¿™ä¸ª","status":true}
        ];
        
        // çŠ¶æ€ç®¡ç†
        let todos = [];
        let apiBaseUrl = '';
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // åŠ è½½å¾…åŠäº‹é¡¹åˆ—è¡¨
            loadTodos();
            
            // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
            setupEventListeners();
        });
        
        // è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
        function setupEventListeners() {
            // æ·»åŠ æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            document.getElementById('add-btn').addEventListener('click', addNewTodo);
            
            // è¾“å…¥æ¡†å›è½¦äº‹ä»¶
            document.getElementById('todo-input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    addNewTodo();
                }
            });
        }
        
        // API è°ƒç”¨å°è£…
        class TodoApi {
            constructor(baseUrl = '') {
                this.baseUrl = "/";
            }
            
            // è·å–æ‰€æœ‰å¾…åŠäº‹é¡¹
            async getAll() {
                return this.fetchFromRealApi(`/`, { method: 'GET'});
            }
            
            // æ·»åŠ å¾…åŠäº‹é¡¹
            async add(todo) {
                return this.fetchFromRealApi(`/add`, {
                    method: 'POST',
                    body: todo,
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    }
                });
            }
            
            // æ›´æ–°å¾…åŠäº‹é¡¹
            async update(id, updates) {
                return this.fetchFromRealApi(`/change`, {
                    method: 'PUT',
                    body: `${id}`,
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    }
                });
            }

            async fetchFromRealApi(url, options) {
                try {
                    const response = await fetch(url, options);
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                    
                    // å°è¯•è§£æ JSONï¼Œå¦‚æœå“åº”æ˜¯ç©ºçš„ï¼ˆå¦‚ DELETEï¼‰ï¼Œåˆ™è¿”å› null
                    const text = await response.text();
                    console.log("hahaha" + text);
                    if (!text) return { success: true, data: null };
                    return { success: true, data: JSON.parse(text) };
                } catch (error) {
                    console.error('API è¯·æ±‚å¤±è´¥:', error);
                    return { 
                        success: false, 
                        error: error.message,
                        data: null 
                    };
                }
            }
        }
        
        // åˆ›å»º API å®ä¾‹
        let todoApi = new TodoApi(apiBaseUrl);
        
        // åŠ è½½å¾…åŠäº‹é¡¹
        async function loadTodos() {
            // æ›´æ–° API å®ä¾‹
            todoApi = new TodoApi(apiBaseUrl);
            
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            renderLoadingState();
            
            // è°ƒç”¨ API
            const result = await todoApi.getAll();
            
            // å¤„ç†ç»“æœ
            if (result.success) {
                todos = result.data || [];
                
                // å¦‚æœæ²¡æœ‰æ•°æ®ä¸”æ˜¯æ¨¡æ‹Ÿæ¥å£ï¼Œåˆå§‹åŒ–æ•°æ®
                if (todos.length === 0 && !apiBaseUrl) {
                    // ä½¿ç”¨åˆå§‹æ•°æ®
                    todos = [...initialTodos];
                }
                
                // æ¸²æŸ“åˆ—è¡¨
                renderTodoList();
                
                // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
                updateStats();
            } else {
                // æ˜¾ç¤ºé”™è¯¯çŠ¶æ€
                renderErrorState(result.error);
            }
        }
        
        // æ¸²æŸ“åŠ è½½çŠ¶æ€
        function renderLoadingState() {
            const todoListEl = document.getElementById('todo-list');
            todoListEl.innerHTML = `
                <div class="loading-state">
                    <div class="loading-icon">â³</div>
                    <h3 class="loading-title">æ­£åœ¨åŠ è½½å¾…åŠäº‹é¡¹...</h3>
                    <p>è¯·ç¨å€™</p>
                </div>
            `;
        }
        
        // æ¸²æŸ“é”™è¯¯çŠ¶æ€
        function renderErrorState(errorMessage) {
            const todoListEl = document.getElementById('todo-list');
            todoListEl.innerHTML = `
                <div class="error-state">
                    <div class="error-icon">âš ï¸</div>
                    <h3 class="error-title">åŠ è½½å¤±è´¥</h3>
                    <p class="error-description">${errorMessage}</p>
                    <button style="margin-top: 20px; padding: 10px 20px; background-color: var(--primary-color); color: white; border: none; border-radius: var(--border-radius); cursor: pointer;" onclick="loadTodos()">
                        é‡è¯•
                    </button>
                </div>
            `;
        }
        
        // æ¸²æŸ“å¾…åŠäº‹é¡¹åˆ—è¡¨
        function renderTodoList() {
            const todoListEl = document.getElementById('todo-list');
            
            // å¦‚æœæ²¡æœ‰å¾…åŠäº‹é¡¹ï¼Œæ˜¾ç¤ºç©ºçŠ¶æ€
            if (todos.length === 0) {
                todoListEl.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">ğŸ“</div>
                        <h3 class="empty-title">æš‚æ— å¾…åŠäº‹é¡¹</h3>
                        <p class="empty-description">æ·»åŠ æ‚¨çš„ç¬¬ä¸€ä¸ªä»»åŠ¡ï¼Œå¼€å§‹é«˜æ•ˆç®¡ç†æ‚¨çš„å·¥ä½œå’Œç”Ÿæ´»ã€‚</p>
                    </div>
                `;
                return;
            }
            
            // æ¸²æŸ“æ‰€æœ‰å¾…åŠäº‹é¡¹
            todoListEl.innerHTML = todos.map(todo => createTodoItemHTML(todo)).join('');
            
            // ä¸ºæ¯ä¸ªå¾…åŠäº‹é¡¹æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
            attachTodoEventListeners();
        }
        
        // åˆ›å»ºå•ä¸ªå¾…åŠäº‹é¡¹çš„HTML
        function createTodoItemHTML(todo) {
            const statusClass = todo.status ? 'completed' : 'pending';
            const statusText = todo.status ? 'å·²å®Œæˆ' : 'æœªå®Œæˆ';
            
            return `
                <div class="todo-item ${todo.status ? 'completed' : ''}" data-id="${todo.id}">
                    <div class="todo-checkbox-container">
                        <input type="checkbox" class="todo-checkbox" id="checkbox-${todo.id}" ${todo.status ? 'checked' : ''}>
                        <div class="custom-checkbox"></div>
                    </div>
                    <div class="todo-content">
                        <div class="todo-text">${todo.todo}</div>
                        <div class="todo-meta">
                            <span class="todo-id">ID: ${todo.id}</span>
                            <span class="todo-status ${statusClass}">${statusText}</span>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // ä¸ºå¾…åŠäº‹é¡¹æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
        function attachTodoEventListeners() {
            // å¤é€‰æ¡†ç‚¹å‡»äº‹ä»¶ - åˆ‡æ¢å®ŒæˆçŠ¶æ€
            document.querySelectorAll('.todo-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const todoId = parseInt(this.id.replace('checkbox-', ''));
                    toggleTodoStatus(todoId, this.checked);
                });
            });
        }
        
        // æ·»åŠ æ–°çš„å¾…åŠäº‹é¡¹
        async function addNewTodo() {
            const inputEl = document.getElementById('todo-input');
            const todoText = inputEl.value.trim();
            
            if (!todoText) {
                showNotification('è¯·è¾“å…¥å¾…åŠäº‹é¡¹å†…å®¹', 'warning');
                inputEl.focus();
                return;
            }
            
            // è°ƒç”¨ API æ·»åŠ 
            const result = await todoApi.add(todoText);
            
            if (result.success) {
                // æ¸…ç©ºè¾“å…¥æ¡†
                inputEl.value = '';
                
                // é‡æ–°åŠ è½½åˆ—è¡¨
                loadTodos();
                
                // æ˜¾ç¤ºæˆåŠŸé€šçŸ¥
                showNotification('å¾…åŠäº‹é¡¹æ·»åŠ æˆåŠŸ', 'success');
            } else {
                // æ˜¾ç¤ºé”™è¯¯é€šçŸ¥
                showNotification(`æ·»åŠ å¤±è´¥: ${result.error}`, 'danger');
            }
        }
        
        // åˆ‡æ¢å¾…åŠäº‹é¡¹çŠ¶æ€
        async function toggleTodoStatus(id, completed) {
            // è°ƒç”¨ API æ›´æ–°
            const result = await todoApi.update(id, { status: completed });
            
            if (result.success) {
                // é‡æ–°åŠ è½½åˆ—è¡¨
                loadTodos();
                
                // æ˜¾ç¤ºé€šçŸ¥
                const statusText = completed ? 'å·²å®Œæˆ' : 'æœªå®Œæˆ';
                showNotification(`ä»»åŠ¡çŠ¶æ€å·²æ›´æ–°ä¸º"${statusText}"`, 'info');
            } else {
                // æ˜¾ç¤ºé”™è¯¯é€šçŸ¥
                showNotification(`æ›´æ–°å¤±è´¥: ${result.error}`, 'danger');
            }
        }
        
        // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
        function updateStats() {
            const total = todos.length;
            const completed = todos.filter(todo => todo.status).length;
            const pending = total - completed;
            
            document.getElementById('total-count').textContent = total;
            document.getElementById('completed-count').textContent = completed;
            document.getElementById('pending-count').textContent = pending;
        }
        
        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(message, type = 'info') {
            // åˆ›å»ºé€šçŸ¥å…ƒç´ 
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.textContent = message;
            
            // è®¾ç½®èƒŒæ™¯é¢œè‰²
            const colors = {
                success: '#4cc9f0',
                danger: '#f72585',
                warning: '#f8961e',
                info: '#4361ee'
            };
            
            notification.style.backgroundColor = colors[type] || colors.info;
            
            // æ·»åŠ åˆ°é¡µé¢
            document.body.appendChild(notification);
            
            // è§¦å‘åŠ¨ç”»
            setTimeout(() => {
                notification.style.opacity = '1';
                notification.style.transform = 'translateX(0)';
            }, 10);
            
            // 3ç§’åç§»é™¤
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100px)';
                
                // åŠ¨ç”»å®Œæˆåç§»é™¤å…ƒç´ 
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }
        
        // å¯¼å‡ºå‡½æ•°ä¾›è°ƒè¯•
        window.loadTodos = loadTodos;
        window.todos = todos;
    </script>
</body>
</html>